<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LS Spin Event</title>

<style>
body{
    margin:0;
    background:#000;
    color:#fff;
    text-align:center;
    font-family:Arial, sans-serif;
}

.logo{
    width:120px;
    margin-top:40px;
}

.container{
    margin-top:40px;
}

input{
    padding:12px;
    font-size:18px;
    background:black;
    color:white;
    border:2px solid white;
    width:250px;
}

button{
    padding:12px 30px;
    font-size:18px;
    cursor:pointer;
    background:white;
    color:black;
    border:none;
    font-weight:bold;
}

button:disabled{
    background:gray;
}

#wheel{
    margin:30px auto;
    width:260px;
    height:260px;
    border-radius:50%;
    border:6px solid white;
    transition:transform 10s ease-out;
    background: conic-gradient(
        #222 0% 50%,
        #fff 50% 100%
    );
}

#pointer{
    width:0;
    height:0;
    border-left:20px solid transparent;
    border-right:20px solid transparent;
    border-bottom:40px solid white;
    margin:auto;
}
</style>
</head>

<body>

<!-- LOGO -->
<img src="logo.jpg.jpeg" class="logo" onerror="this.style.display='none'">

<!-- PASSWORD PAGE -->
<div class="container" id="passwordPage">
    <h2>Enter Event Password</h2>
    <input type="password" id="passwordInput"
           onkeypress="if(event.key==='Enter'){checkPassword();}">
    <br><br>
    <button type="button" onclick="checkPassword()">Enter</button>
    <p id="errorMsg" style="color:red;"></p>
</div>

<!-- SPIN PAGE -->
<div class="container" id="spinPage" style="display:none;">
    <div id="pointer"></div>
    <div id="wheel"></div>
    <br>
    <button id="spinBtn" onclick="spinWheel()">SPIN</button>
    <h2 id="result"></h2>
</div>

<script>

const correctPassword = "LSSATYA0717";

// Block back button
history.pushState(null, null, location.href);
window.onpopstate = function () {
    history.go(1);
};

// If already played
if(localStorage.getItem("played") === "yes"){
    document.body.innerHTML="<h2 style='margin-top:120px;'>You Already Played!</h2>";
}

// Password check
function checkPassword(){
    let pass = document.getElementById("passwordInput").value;

    if(pass === correctPassword){
        document.getElementById("passwordPage").style.display="none";
        document.getElementById("spinPage").style.display="block";
    } else {
        document.getElementById("errorMsg").innerText="Wrong Password!";
    }
}

// Spin function
function spinWheel(){

    if(localStorage.getItem("played") === "yes"){
        return;
    }

    let spinCount = localStorage.getItem("spinCount");
    if(!spinCount){
        spinCount = 0;
    }

    spinCount = parseInt(spinCount) + 1;
    localStorage.setItem("spinCount", spinCount);

    let win = false;

    // 16 lose + 17th win
    if(spinCount % 17 === 0){
        win = true;
    }

    let wheel = document.getElementById("wheel");
    let spinBtn = document.getElementById("spinBtn");

    spinBtn.disabled = true;

    let rotateDegree;

    if(win){
        rotateDegree = 3600 + 270; 
    }else{
        rotateDegree = 3600 + 90;  
    }

    wheel.style.transform = "rotate("+rotateDegree+"deg)";

    setTimeout(function(){
        if(win){
            document.getElementById("result").innerText="FREE ðŸŽ‰";
        }else{
            document.getElementById("result").innerText="BETTER LUCK NEXT TIME";
        }

        localStorage.setItem("played","yes");

    }, 10000);
}

</script>

</body>
</html>
